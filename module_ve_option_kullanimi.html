
<!doctype html>
<html lang="tr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nixogreniyoruz.kavakci.dev/module_ve_option_kullanimi.html">
      
      
        <link rel="prev" href="nix_ile_nix_konfigurasyonu.html">
      
      
        <link rel="next" href="nixos_kurulumu_ve_konfigurasyonu.html">
      
      
      <link rel="icon" href="assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Module ve Option Kullanımı - NixOS Öğreniyoruz - Murat Çabuk</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%208a4%204%200%200%200-4%204%204%204%200%200%200%204%204%204%204%200%200%200%204-4%204%204%200%200%200-4-4%22/%3E%3C/svg%3E');}</style>


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Module ve Option Kullanımı - NixOS Öğreniyoruz - Murat Çabuk" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://nixogreniyoruz.kavakci.dev/assets/images/social/module_ve_option_kullanimi.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nixogreniyoruz.kavakci.dev/module_ve_option_kullanimi.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Module ve Option Kullanımı - NixOS Öğreniyoruz - Murat Çabuk" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://nixogreniyoruz.kavakci.dev/assets/images/social/module_ve_option_kullanimi.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="#7EBAE4" data-md-color-accent="#7EBAE4">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-ve-option-kullanm" class="md-skip">
          Ana içeriğe geç
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Başlık">
    <a href="index.html" title="NixOS Öğreniyoruz - Murat Çabuk" class="md-header__button md-logo" aria-label="NixOS Öğreniyoruz - Murat Çabuk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m7.352 1.592-1.364.002L5.32 2.75l1.557 2.713-3.137-.008-1.32 2.34h11.69l-1.353-2.332-3.192-.006-2.214-3.865zm6.175 0-2.687.025 5.846 10.127 1.341-2.34-1.59-2.765 2.24-3.85-.683-1.182h-1.336l-1.57 2.705-1.56-2.72zm6.887 4.195-5.846 10.125 2.696-.008 1.601-2.76 4.453.016.682-1.183-.666-1.157-3.13-.008L21.778 8.1l-1.365-2.313zM9.432 8.086l-2.696.008-1.601 2.76-4.453-.016L0 12.02l.666 1.157 3.13.008-1.575 2.71 1.365 2.315zM7.33 12.25l-.006.01-.002-.004-1.342 2.34 1.59 2.765-2.24 3.85.684 1.182H7.35l.004-.006h.001l1.567-2.698 1.558 2.72 2.688-.026-.004-.006h.01zm2.55 3.93 1.354 2.332 3.192.006 2.215 3.865 1.363-.002.668-1.156-1.557-2.713 3.137.008 1.32-2.34z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NixOS Öğreniyoruz - Murat Çabuk
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Module ve Option Kullanımı
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="slate" data-md-color-primary="#7EBAE4" data-md-color-accent="#7EBAE4"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="default" data-md-color-primary="#7EBAE4" data-md-color-accent="#7EBAE4"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Ara" placeholder="Ara" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Ara">
        
        <button type="reset" class="md-search__icon md-icon" title="Temizle" aria-label="Temizle" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Arama başlatılıyor
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/LinuxTurkey/nix-ogreniyoruz" title="Depoya git" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LinuxTurkey/nix-ogreniyoruz
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigasyon" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="NixOS Öğreniyoruz - Murat Çabuk" class="md-nav__button md-logo" aria-label="NixOS Öğreniyoruz - Murat Çabuk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m7.352 1.592-1.364.002L5.32 2.75l1.557 2.713-3.137-.008-1.32 2.34h11.69l-1.353-2.332-3.192-.006-2.214-3.865zm6.175 0-2.687.025 5.846 10.127 1.341-2.34-1.59-2.765 2.24-3.85-.683-1.182h-1.336l-1.57 2.705-1.56-2.72zm6.887 4.195-5.846 10.125 2.696-.008 1.601-2.76 4.453.016.682-1.183-.666-1.157-3.13-.008L21.778 8.1l-1.365-2.313zM9.432 8.086l-2.696.008-1.601 2.76-4.453-.016L0 12.02l.666 1.157 3.13.008-1.575 2.71 1.365 2.315zM7.33 12.25l-.006.01-.002-.004-1.342 2.34 1.59 2.765-2.24 3.85.684 1.182H7.35l.004-.006h.001l1.567-2.698 1.558 2.72 2.688-.026-.004-.006h.01zm2.55 3.93 1.354 2.332 3.192.006 2.215 3.865 1.363-.002.668-1.156-1.557-2.713 3.137.008 1.32-2.34z"/></svg>

    </a>
    NixOS Öğreniyoruz - Murat Çabuk
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LinuxTurkey/nix-ogreniyoruz" title="Depoya git" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LinuxTurkey/nix-ogreniyoruz
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NixOS
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Nix Dili
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Nix Dili
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_lang/01_nix_dili_ve_ozellikleri.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Dili ve Özellikleri
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_lang/02_nix_dili_alistirmalari.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Dili ile İlgili Alıştırmalar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_lang/03_nix_dili_gomulu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Dilinde Gömülü Fonksiyonlar
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Nix Paket Yöneticisi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Nix Paket Yöneticisi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/nix_paket_yoneticisi.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Paket Yöneticisi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/nix_shell_ve_profile.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Shell ve Profile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/nix_flake_nedir.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix Flake Nedir?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/birden_cok_paketi_ayni_repo_uzerinden_yayinlamak.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Birden Çok Paketi Aynı Repo Üzeriden Yayınlamak
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/override_ve_overlay.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Override ve Overlay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_package/developer_ve_profile_ortamlari_olusturmak.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer ve Profile Ortamları Oluşturmak
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Sonrası
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Sonrası
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nix_ile_nix_konfigurasyonu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nix ile NixOS Konfigürasyonu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Module ve Option Kullanımı
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="module_ve_option_kullanimi.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Module ve Option Kullanımı
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="İçindekiler">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      İçindekiler
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-type" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-ve-option-kullanm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Module ve Option Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bir-modulu-baska-bir-module-eklemek" class="md-nav__link">
    <span class="md-ellipsis">
      Bir Modülü Başka Bir Modüle Eklemek
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodule-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      Submodule Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkif-mkmerge-mkforce-mkdefault-mkoverride-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      mkIf, mkMerge, mkForce, mkDefault, mkOverride Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkorder-mkbefore-ve-mkafter-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      mkOrder, mkBefore ve mkAfter Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modul-ve-optionlar-daha-detayl-ogrenmek-icin-kaynaklar" class="md-nav__link">
    <span class="md-ellipsis">
      Modül ve Option'ları Daha Detaylı Öğrenmek İçin Kaynaklar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaynaklar" class="md-nav__link">
    <span class="md-ellipsis">
      Kaynaklar
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nixos_kurulumu_ve_konfigurasyonu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NixOS Kurulumu ve Konfigürasyonu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nixos_cloud_ve_uzak_ortam.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NixOS'u Cloud ve Uzak Ortamlara Deploy Etmek
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="İçindekiler">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      İçindekiler
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-type" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-ve-option-kullanm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Module ve Option Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bir-modulu-baska-bir-module-eklemek" class="md-nav__link">
    <span class="md-ellipsis">
      Bir Modülü Başka Bir Modüle Eklemek
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submodule-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      Submodule Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkif-mkmerge-mkforce-mkdefault-mkoverride-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      mkIf, mkMerge, mkForce, mkDefault, mkOverride Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkorder-mkbefore-ve-mkafter-kullanm" class="md-nav__link">
    <span class="md-ellipsis">
      mkOrder, mkBefore ve mkAfter Kullanımı
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modul-ve-optionlar-daha-detayl-ogrenmek-icin-kaynaklar" class="md-nav__link">
    <span class="md-ellipsis">
      Modül ve Option'ları Daha Detaylı Öğrenmek İçin Kaynaklar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaynaklar" class="md-nav__link">
    <span class="md-ellipsis">
      Kaynaklar
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/LinuxTurkey/nix-ogreniyoruz/edit/main/src/module_ve_option_kullanimi.md" title="Düzenle" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/LinuxTurkey/nix-ogreniyoruz/raw/main/src/module_ve_option_kullanimi.md" title="Sayfanın kaynağını görüntüle" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="module-ve-option-kullanm">Module ve Option Kullanımı</h1>
<p>Bu yazı büyük ihtimal serinin en uzun yazısı olacak. Konuyu büyük ihtimal tek seferde okuyup bitirmek isteyeceksiniz. Belki en çok git gel yapacağınız yazı da bu olacak.</p>
<p>Bu yazıda ilk yazılarımızda sıkça kullandığımız <code>nix repl</code> aracını bol bol kullanacağız. Module yazarken sıkça yapılan hataları inceleyeceğiz. Bu yazıda amacımız doğrudan çalışabilir module yazmak değil. ONu da bir sonraki yazımızda yapacağız. Yani Orta halli bir NixOS konfigürasyonu yapacağız. Orada ihtiyacımız olan bir kaç modülü de yazmış olacağız.</p>
<p>İlk yazılarımızda <code>nix repl</code> aracını sık sık kullanmıştık. Ancak doğrudan bu sayfaya gelenler veya unutmuş olanlar için ufak bir bahsedelim.</p>
<p>Terminalden <code>nix repl</code> dediğimizde cli açılacaktır. Burada amaç developer'lar için kodlarını tet edebilecekleri hatalarını görebilecekleri bir araç sunmak. <code>:?</code> komutu ile alttaki yardım metnine ulaşabilirsiniz.</p>
<div class="highlight"><pre><span></span><code>The following commands are available:

  &lt;expr&gt;                       Evaluate and print expression
  &lt;x&gt; = &lt;expr&gt;                 Bind expression to variable
  :a, :add &lt;expr&gt;              Add attributes from resulting set to scope
  :b &lt;expr&gt;                    Build a derivation
  :bl &lt;expr&gt;                   Build a derivation, creating GC roots in the
                               working directory
  :e, :edit &lt;expr&gt;             Open package or function in $EDITOR
  :i &lt;expr&gt;                    Build derivation, then install result into
                               current profile
  :l, :load &lt;path&gt;             Load Nix expression and add it to scope
  :lf, :load-flake &lt;ref&gt;       Load Nix flake and add it to scope
  :p, :print &lt;expr&gt;            Evaluate and print expression recursively
  :q, :quit                    Exit nix-repl
  :r, :reload                  Reload all files
  :sh &lt;expr&gt;                   Build dependencies of derivation, then start
                               nix-shell
  :t &lt;expr&gt;                    Describe result of evaluation
  :u &lt;expr&gt;                    Build derivation, then start nix-shell
  :doc &lt;expr&gt;                  Show documentation of a builtin function
  :log &lt;expr&gt;                  Show logs for a derivation
  :te, :trace-enable [bool]    Enable, disable or toggle showing traces for
                               errors
  :?, :help                    Brings up this help menu
</code></pre></div>
<p>Nix dosyalarına yazdığımız expression'ları doğrudan repl içine yazıp çağırabiliriz ya da bir nix dosyasını load (:l) komutu ile repl içine yükleyebiliriz. Oluşan verileri de print (:p) komutu ile görebiliriz.</p>
<div class="highlight"><pre><span></span><code>nix-repl&gt;<span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="o">]</span>

nix-repl&gt;<span class="w"> </span>a
<span class="c1">#[ 1 2 3 4 ]</span>

nix-repl&gt;<span class="w"> </span>:p<span class="w"> </span>a
<span class="c1">#[ 1 2 3 4 ]</span>

nix-repl&gt;<span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="nv">a</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="nv">b</span><span class="o">=</span><span class="m">2</span><span class="p">;</span><span class="nv">c</span><span class="o">=</span><span class="m">3</span><span class="p">;</span><span class="o">}</span>

nix-repl&gt;<span class="w"> </span>:p<span class="w"> </span>b
<span class="c1">#{ a = 1; b = 2; c = 3; }</span>

nix-repl&gt;<span class="w"> </span><span class="nv">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>a:<span class="w"> </span>b:<span class="w"> </span>a<span class="w"> </span>+<span class="w"> </span>b

nix-repl&gt;<span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>func<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>

nix-repl&gt;<span class="w"> </span>:p<span class="w"> </span>result
<span class="c1">#3</span>
</code></pre></div>
<p>Biraz kurcalayarak rahatlıkla uzmanı olabilirsiniz. Ancak tabi Nix dilinin uzmanı olmak biraz vakit alabilir. Bunun için ilk yazılarımızı okuyabilirsiniz. Repl hakkında daha fazla bilgi almak için <a href="https://aldoborrero.com/posts/2022/12/02/learn-how-to-use-the-nix-repl-effectively/">şu sayfayı</a> da ziyaret edebilirsiniz.</p>
<p>Diğer bir yararlı araç da <code>nix eval</code> komutu. Bu komut ile bir nix dosyasını çalıştırabilir ve sonucunu görebilirsiniz.</p>
<div class="highlight"><pre><span></span><code>nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>--raw<span class="w"> </span>nixpkgs#lib.version
<span class="c1">#24.05.20240223.48b75eb%</span>


nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>--raw<span class="w"> </span>nixpkgs#hello
<span class="c1">#/nix/store/63l345l7dgcfz789w1y93j1540czafqh-hello-2.12.1%</span>


nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>--write-to<span class="w"> </span>./out<span class="w"> </span>--expr<span class="w"> </span><span class="s1">&#39;{ foo = &quot;bar&quot;; subdir.bla = &quot;123&quot;; }&#39;</span>
cat<span class="w"> </span>./out/foo
<span class="c1"># bar</span>
cat<span class="w"> </span>./out/subdir/bla
<span class="c1">#123</span>
</code></pre></div>
<p>Module yapısı ile ilgili tüm gerekenler lib kütüphanesi içinde yer alıyor. Resmi sayfasında lib klasöründeki <a href="https://github.com/NixOS/nixpkgs/blob/master/lib/default.nix">default.nix</a> dosyasına bakacak olursanız alttaki satıları görebilirsiniz. Modules dosyasında modüllerle ilgili fonksiyonlar yer alırken options dosyasında ise option'larla ilgili fonksiyonlar yer alır. Tabi ben böyle yazınca mantıklı geliyor :) zaten öyle olmamalı mıydı? diyebilirsiniz. Ancak kod yazarken özellikle bir module yazarken bu ayrımı yapmak bazen zor olabiliyor. Kafanız karıştığında dediğimi hatırlarsınız.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># kısaltıldı</span>

    <span class="c1"># module system</span>
    <span class="ss">modules</span> <span class="o">=</span> callLibs <span class="l">./modules.nix</span><span class="p">;</span>
    <span class="ss">options</span> <span class="o">=</span> callLibs <span class="l">./options.nix</span><span class="p">;</span>
    <span class="ss">types</span> <span class="o">=</span> callLibs <span class="l">./types.nix</span><span class="p">;</span>

<span class="c1"># kısaltıldı</span>
</code></pre></div>
<p>Bazen hata bulmak veya ne yapacağınızı anlayabilmek için bu dosyalara bakmamız gerekebilir.</p>
<p>Modules dosyasında bir çok fonksiyon bulunuyor ancak bizim çok iyi bilmemiz gerekenler kalın olarak işaretlediklerim.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>evalModules</strong></td>
<td>filterOverrides</td>
</tr>
<tr>
<td>filterOverrides'</td>
<td>fixMergeModules</td>
</tr>
<tr>
<td>fixupOptionType # should be private?</td>
<td></td>
</tr>
<tr>
<td>importJSON</td>
<td>importTOML</td>
</tr>
<tr>
<td>mergeDefinitions</td>
<td>mergeAttrDefinitionsWithPrio</td>
</tr>
<tr>
<td>mergeOptionDecls</td>
<td><strong>mkAfter</strong></td>
</tr>
<tr>
<td>mkAliasAndWrapDefinitions</td>
<td>mkAliasAndWrapDefsWithPriority</td>
</tr>
<tr>
<td>mkAliasDefinitions</td>
<td>mkAliasIfDef</td>
</tr>
<tr>
<td>mkAliasOptionModule</td>
<td>mkAliasOptionModuleMD</td>
</tr>
<tr>
<td><strong>mkAssert</strong></td>
<td><strong>mkBefore</strong></td>
</tr>
<tr>
<td>mkChangedOptionModule</td>
<td><strong>mkDefault</strong></td>
</tr>
<tr>
<td>mkDerivedConfig</td>
<td>mkFixStrictness</td>
</tr>
<tr>
<td><strong>mkForce</strong></td>
<td><strong>mkIf</strong></td>
</tr>
<tr>
<td>mkImageMediaOverride</td>
<td><strong>mkMerge</strong></td>
</tr>
<tr>
<td>mkMergedOptionModule</td>
<td>mkOptionDefault</td>
</tr>
<tr>
<td><strong>mkOrder</strong></td>
<td><strong>mkOverride</strong></td>
</tr>
<tr>
<td>mkRemovedOptionModule</td>
<td>mkRenamedOptionModule</td>
</tr>
<tr>
<td>mkRenamedOptionModuleWith</td>
<td>mkVMOverride</td>
</tr>
<tr>
<td>setDefaultModuleLocation</td>
<td>sortProperties;</td>
</tr>
</tbody>
</table>
<p>Options Doyasına bakacak olursak alttaki gibi bir liste ile karşılaşıyoruz. Burada da yine iyi bilmemiz gerekenleri kalın olarak işaretledim.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>isOption</strong></td>
<td><strong>mkOption</strong></td>
</tr>
<tr>
<td><strong>mkEnableOption</strong></td>
<td><strong>mkPackageOption</strong></td>
</tr>
<tr>
<td>mkPackageOptionMD</td>
<td><strong>mergeDefaultOption</strong></td>
</tr>
<tr>
<td>mergeOneOption</td>
<td>mergeUniqueOption</td>
</tr>
<tr>
<td>mergeEqualOption</td>
<td>getValues</td>
</tr>
<tr>
<td>getFiles</td>
<td>optionAttrSetToDocList</td>
</tr>
<tr>
<td>scrubOptionValue</td>
<td>renderOptionValue</td>
</tr>
<tr>
<td>literalExpression</td>
<td>mdDoc</td>
</tr>
<tr>
<td>literalMD</td>
<td>showOption</td>
</tr>
<tr>
<td>showFiles</td>
<td>showDefs</td>
</tr>
</tbody>
</table>
<p>types dosyasında ise alttaki tiplerin tanımın görebiliriz.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>bool</td>
<td>true, false</td>
</tr>
<tr>
<td>boolByOr</td>
<td>eğer iki tanımlama da true ise sonuç true'dur.</td>
</tr>
<tr>
<td>path</td>
<td>path tanımlamak için kullanılır. eğer paket tanımı/adresi kullanılacaksa, yani amaç bir paketse package tipi kullanılmalı</td>
</tr>
<tr>
<td>package</td>
<td>bir derivation veya flake içeren path</td>
</tr>
<tr>
<td>pathInStore</td>
<td>nix store içeren bir path</td>
</tr>
<tr>
<td>anything</td>
<td>tip bilinmediğinde kullanılabilir</td>
</tr>
<tr>
<td>raw</td>
<td>eğer tip checking, merging veya nested evaluation yapmıyorsa kullanılabilir.</td>
</tr>
<tr>
<td>pkgs</td>
<td>paket seti</td>
</tr>
<tr>
<td>int</td>
<td>tam sayı</td>
</tr>
<tr>
<td>ints</td>
<td>tam sayı seti</td>
</tr>
<tr>
<td>ints.positive</td>
<td>pozitif tam sayılar</td>
</tr>
<tr>
<td>port</td>
<td>port numarası</td>
</tr>
<tr>
<td>float</td>
<td>noktalı sayı</td>
</tr>
<tr>
<td>number</td>
<td>float veya int olabilir</td>
</tr>
<tr>
<td>str</td>
<td>metin ifadesi</td>
</tr>
<tr>
<td>lines</td>
<td>satırlardan oluşan string ifade</td>
</tr>
<tr>
<td>commas</td>
<td>virgül ile birleştirilmiş metinler</td>
</tr>
<tr>
<td>envVar</td>
<td>iki nokta üst üste (\:) ile birleştirilmiş metinler</td>
</tr>
<tr>
<td>strmathing</td>
<td>regular expression ile eşleşen metin. Ayrı değerler tekrarlamaz</td>
</tr>
<tr>
<td>submodule, submoduleWith</td>
<td>bir başka module'u ifade eden tip</td>
</tr>
<tr>
<td>listOf t</td>
<td>t tipinde liste</td>
</tr>
<tr>
<td>attrOf t</td>
<td>value değerlerinin tipi t olan set</td>
</tr>
<tr>
<td>nullOr t</td>
<td>null veya t tipi</td>
</tr>
<tr>
<td>uniq t</td>
<td>t tipi sadece bir kez ifade edilebilir. Birden fazla değer merge edilemez</td>
</tr>
<tr>
<td>oneOf [ t1 t2 … ]</td>
<td>tiplerden biri</td>
</tr>
<tr>
<td>either t1 t2</td>
<td>t1 tipi veya t2 tipi</td>
</tr>
<tr>
<td>coercedTo from f to</td>
<td>from tipinde bir tip alıp to tipini döndüren bir fonksiyon</td>
</tr>
</tbody>
</table>
<p>Submodule tipi için bir kaç açıklama yapmamız gerekiyor.</p>
<h2 id="custom-type">Custom Type</h2>
<p>Bunu için mkOptionType fonksiyonu kullanılır. <a href="https://nixos.org/manual/nixos/stable/#sec-option-types-custom">Resmi dokümanlarında</a> da denildiği gibi custom yip yazmak biraz çetrefilli bir iş. Ben de zaten giriş mahiyetinde bir şeyler yazacağım.</p>
<p>Amacımız kullanacağımız option ve modüllerde geçen terim ve tabirlere de aşina olmak.</p>
<p>Gerekli parametreler</p>
<ul>
<li><strong>name</strong> : Tipin adı</li>
<li><strong>description</strong>: Tipin açıklaması</li>
<li><strong>check</strong>: Tipin için type check fonksiyonu. True ve false döndürmelidir.</li>
<li><strong>merge</strong>: Birden fazla değer merge edilirken kullanılacak fonksiyon. Bir tip için birden fazla değer farklı yerlerde atanmış olabilir. Bunların merge edilirken nasıl birleştirileceğini belirler. Sonuçta nihai bir değer elde etmek için kullanılır.</li>
<li><strong>getSubModules</strong>: Submodule tipleri üretmek için gereklidir.</li>
<li><strong>getSubOptions</strong>: Bütün submodule'lerin option'larına erişmek için kullanılır.</li>
<li><strong>substSubModules</strong>: Bir modülü parametre olarak alır ve geriye modülün parametrelerini değiştirerek döndürür.</li>
</ul>
<p>Özet olarak tipleri kullanırken bu başlıktan çıkartacağımız sonuçlar</p>
<ul>
<li>tiplerin türü önemli</li>
<li>ve tiplerini merge edilmesi gibi bir durum var bu nedenle doğru değerlerle ve öncelikle doğru belirlenerek kullanılmaları gerekiyor.</li>
</ul>
<h2 id="module-ve-option-kullanm_1">Module ve Option Kullanımı</h2>
<p>Şimdi örneklerle mevzuyu anlamaya çalışalım. Özellikle belirtmediğim sürece bu yazıda yaptıklarımı Nix kurulu herhangi bir sistemde yapabilirsiniz.</p>
<p>Alttaki gibi basit bir module (default.nix) yazalım.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>
 <span class="p">{</span> lib<span class="p">,</span> <span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>
    <span class="p">};</span>

 <span class="p">}</span>
</code></pre></div>
<p>Daha sonra yazdığımız modülünü doğrulama için evaluate fonksiyonunda geçirelim. Bu fonksiyon Nix dili içinde bulunan ve modül dosyalarını değerlendirmek için kullanılan bir fonksiyondur. Bu fonksiyon, bir veya birden fazla Nix modül dosyasını yükler, değerlendirir ve sonuçları birleştirir.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># eval.nix</span>
<span class="k">let</span>
  <span class="ss">system</span> <span class="o">=</span> <span class="s2">&quot;x86_64-linux&quot;</span><span class="p">;</span>
  <span class="ss">pkgs</span> <span class="o">=</span> <span class="nb">import</span> <span class="l">&lt;nixpkgs&gt;</span> <span class="p">{</span><span class="k">inherit</span> system<span class="p">;</span> <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span><span class="ss">allowUnfree</span> <span class="o">=</span> <span class="no">true</span><span class="p">;};</span> <span class="ss">overlays</span> <span class="o">=</span> <span class="p">[];</span> <span class="p">};</span>
<span class="k">in</span>
pkgs<span class="o">.</span>lib<span class="o">.</span>evalModules <span class="p">{</span>
  <span class="ss">modules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="l">./default.nix</span>
  <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>evalModules fonksiyonunun içeriğini görmek için repl içinde alttaki komutları çalıştırabilirsiniz. Görüldüğü üzere tek zorunlu parametre modules. Diğer parametreler ise opsiyonel.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># nix paket koleksiyonunu indiriyoruz</span>
:l<span class="w"> </span>&lt;nixpkgs&gt;

<span class="c1"># evalModules içerğini editleme modunda açıyoruz.</span>
<span class="c1"># çıkmak için ctrl+q yapmalısınız.</span>
:e<span class="w"> </span>lib.evalModules

<span class="c1"># kısaltıldı</span>
<span class="c1"># evalModules = evalModulesArgs@</span>
<span class="c1">#                 { modules</span>
<span class="c1">#                 , prefix ? []</span>
<span class="c1">#                 , specialArgs ? {}</span>
<span class="c1">#                 , class ? null</span>
<span class="c1">#                 , args ? {}</span>
<span class="c1">#                 , check ? true</span>
<span class="c1">#                 }:</span>
<span class="c1">#     let</span>
<span class="c1">#       withWarnings = x:</span>
<span class="c1"># kısaltıldı</span>
</code></pre></div>
<p>Şimdi kodumuzu test edelim.</p>
<div class="highlight"><pre><span></span><code>nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>-f<span class="w"> </span>eval.nix

<span class="c1"># error: The option `scripts.output&#39; is used but not defined.</span>
</code></pre></div>
<p>Sonuç olarak bir option tanımladığımızı ancak kullanmadığımız belirten bir hata aldık.</p>
<p>Aynı testi repl içinde de yapabiliriz.</p>
<div class="highlight"><pre><span></span><code><span class="nv">myModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>import<span class="w"> </span>./eval.nix
:p<span class="w"> </span>myModule
<span class="c1"># error: The option `scripts.output&#39; is used but not defined.»; }; }; }; type = «repeated»; }</span>
</code></pre></div>
<p>Benzer bi hata aldık.</p>
<p>O zaman config bloğumuzu tanımlayalım. default.nix dosyamızı alttaki gibi değiştirelim.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>
 <span class="p">{</span> lib<span class="p">,</span> <span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>
    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
     scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="p">};</span>
 <span class="p">}</span>
</code></pre></div>
<p>Şimdi tekrar test edelim.</p>
<div class="highlight"><pre><span></span><code>nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>-f<span class="w"> </span>eval.nix

<span class="c1"># error: A definition for option `scripts.output&#39; is not of type `strings concatenated with &quot;\n&quot;&#39;. Definition values:</span>
<span class="c1"># - In `/home/.../.../default.nix&#39;: 42</span>
</code></pre></div>
<p>Evet gayet mantıklı bir hata aldık. Çünkü bizim tanımladığımız tip lines iken biz bir sayı tanımladık.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>
 <span class="p">{</span> lib<span class="p">,</span> <span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>
    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
     scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s2">&quot;wget https://www.google.com -O /etc/test.txt&quot;</span><span class="p">;</span>
    <span class="p">};</span>
 <span class="p">}</span>
</code></pre></div>
<p>Şimdi test ettiğimizde ise alttaki gibi bir durum gördük. Bu durum belki siz baktığınızda düzelmiş olabilir. Bu yazı dizisinde tamamen yeni teknolojiye uygun komutların göreceğimizden bahsetmiştim ancak ilk kez burada tıkandık. Temel sebebi ise <a href="https://github.com/NixOS/nix/issues/7701">Nix Github sayfasından</a> da takip edebileceğiniz üzere halen bir çok komutun stabil olmaması. Yani bu vakte kadar kullanımda bir problem yaşamadık ki sadece ben değil internette de görebileceğiniz üzere birçok kişi son sürüm komutları kullanıyor. Zaten bu yaşadığımız durumda çalışmasına engel bir durum değil. <code>evalModule</code> fonksiyonu bildiğimiz üzere gerçekten kodları çalıştırmıyor. Bu nedenle özel durumları yönetmek üzere dizayn edilmemiş. Ancak burada yaşanan durumu <code>nix eval</code> komutu handle etmeliydi ancak o da en azından bu durumu yönetemiyor. Bu nedenle eski komutlardan biri olan <code>nix-instantiate</code> komutunu kullanarak test edebiliriz.</p>
<div class="highlight"><pre><span></span><code>nix<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>-f<span class="w"> </span>eval.nix

<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
<span class="c1"># trace: warning: Use `stdenv.tests` instead. `passthru` is a `mkDerivation` detail.</span>
</code></pre></div>
<p><code>nix-instantiate</code> ile test etmek için de alttaki komutu kullanabiliriz. Komut ile eval.nix dosyasını config bloğunun ürettiği sonuçları çağırabiliyoruz.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate<span class="w"> </span>--eval<span class="w"> </span>eval.nix<span class="w"> </span>-A<span class="w"> </span>config.scripts.output
<span class="c1"># &quot;wget https://www.google.com -O /etc/test.txt&quot;</span>
</code></pre></div>
<p>Şimdi paket üreten bir option tanımlayalım. Amacımız nixpkgs koleksiyonundan bir paketi kullanarak bir shell script'i yazıp bunu paket olarak option olarak modülle ayarlamak. Bunu yaparken de script'i daha önce oluşturduğumuz <code>scripts.output</code> option'ından alacağız.</p>
<p>Bu işlemleri yapabilmemiz için default.nix dosyamıza pkgs ve config parametrelerini eklememiz gerekiyor. Hatırlarsanız yukarıda aynı modül içinde dahi olsalar bir option'a doğrudan değil merkezi config setinden erişmemiz gerekiyor demiştik. <code>script.paket</code> option değerini atadığımız yerde <code>config.scripts.output</code> değerini kullandığımıza dikkat edin.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>

<span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span>config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>

       scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
         <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
       <span class="p">};</span>

    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s2">&quot;wget https://www.google.com -O /etc/test.txt&quot;</span><span class="p">;</span>

      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                 <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;create-etc&quot;</span><span class="p">;</span>
                 <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> wget <span class="p">];</span>
                 <span class="ss">text</span> <span class="o">=</span> config<span class="o">.</span>scripts<span class="o">.</span>output<span class="p">;</span>
     <span class="p">};</span>

    <span class="p">};</span>
 <span class="p">}</span>
</code></pre></div>
<p>Eval.nix dosyamızı da alttaki gibi değiştirelim. Modülümüz artık pkgs ve config parametrelerini de istiyor. Ancak biz sadece pkgs parametresini hazırlasak yeterli olacaktır. Çünkü config ve lib parametresi modülün içine modül eko-sistemi/kurgusu tarafından otomatik olarak ekleniyor.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#eval.nix</span>

<span class="k">let</span>

  <span class="ss">system</span> <span class="o">=</span> <span class="s2">&quot;x86_64-linux&quot;</span><span class="p">;</span>
  <span class="ss">pkgs</span> <span class="o">=</span> <span class="nb">import</span> <span class="l">&lt;nixpkgs&gt;</span> <span class="p">{</span><span class="k">inherit</span> system<span class="p">;</span> <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span><span class="ss">allowUnfree</span> <span class="o">=</span> <span class="no">true</span><span class="p">;};</span> <span class="ss">overlays</span> <span class="o">=</span> <span class="p">[];</span> <span class="p">};</span>



<span class="k">in</span>
  pkgs<span class="o">.</span>lib<span class="o">.</span>evalModules <span class="p">{</span>

    <span class="ss">modules</span> <span class="o">=</span> <span class="p">[</span>
              <span class="c1"># alttaki satırı kapatıp specialArg&#39;ı kullandık. Burada aslında anonymous foksiyon açlıştırıp bir modül döndürüyoruz  aslında.</span>
              <span class="c1"># bu modülde bağlı olduğu modün bir argümanını dolduruyor.</span>
              <span class="c1"># specialArgs ise doğrudan modülün argumanlarını ekliyor.</span>
              <span class="c1">#({ config, ... }: { config._module.args = { pkgs = pkgs; }; })</span>
               <span class="l">./default.nix</span>
              <span class="p">];</span>
                <span class="ss">specialArgs</span> <span class="o">=</span> <span class="p">{</span><span class="ss">pkgs</span> <span class="o">=</span> pkgs<span class="p">;</span> <span class="p">};</span>

  <span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>nix-instantiate<span class="w"> </span>--eval<span class="w"> </span>eval.nix<span class="w"> </span>-A<span class="w"> </span>config.scripts.paket

<span class="c1"># sonuç olarak elimizde bir paketin attribute&#39;ları listelenmiş oldu.</span>
<span class="c1"># { __ignoreNulls = true; __structuredAttrs = false; all = &lt;CODE&gt;; allowSubstitutes = true; args = &lt;CODE&gt;; buildCommand = &lt;CODE&gt;; buildInputs = &lt;CODE&gt;; builder = &lt;CODE&gt;; checkPhase = &lt;CODE&gt;; cmakeFlags = &lt;CODE&gt;; configureFlags = &lt;CODE&gt;; depsBuildBuild = &lt;CODE&gt;; depsBuildBuildPropagated = &lt;CODE&gt;;</span>
</code></pre></div>
<h2 id="bir-modulu-baska-bir-module-eklemek">Bir Modülü Başka Bir Modüle Eklemek</h2>
<p>Bir modül içine başka modül de ekleyebiliriz. Örneğin alttaki gibi bir modül (my-module.nix) yazalım. Config bloğu içinde <code>scripts.output</code> ile default altındaki config'de de yaptığımız atamanın ayn ısını yaptık. Yani aynı konfigürasyon farklı modüllerde tekrar yapıldı yani.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># my-module.nix</span>
<span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span>config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>

      apps<span class="o">.</span><span class="ss">message</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
      <span class="p">};</span>

    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
              apps<span class="o">.</span><span class="ss">message</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                                      <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;hello-app&quot;</span><span class="p">;</span>
                                      <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> cowsay <span class="p">];</span>
                                      <span class="ss">text</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                cowsay </span><span class="si">${</span>config<span class="o">.</span>scripts<span class="o">.</span>output<span class="si">}</span>
<span class="s s-Multiline">                                              &#39;&#39;</span><span class="p">;</span>
                    <span class="p">};</span>
              scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                      sample script</span>
<span class="s s-Multiline">                      &#39;&#39;</span><span class="p">;</span>
                    <span class="p">};</span>
              <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<p>Bu modülü default.nix dosyasına imports listesi ekleyebiliriz ekleyelim.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span>config<span class="p">,</span><span class="o">...</span> <span class="p">}:{</span>
    <span class="ss">imports</span> <span class="o">=</span> <span class="p">[</span>
      <span class="l">./my-module.nix</span>
    <span class="p">];</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
          <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>

      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
          <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
      <span class="p">};</span>

    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                      wget https://www.google.com -O /etc/test.txt</span>
<span class="s s-Multiline">                      &#39;&#39;</span><span class="p">;</span>

      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                                      <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;create-etc&quot;</span><span class="p">;</span>
                                      <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> wget <span class="p">];</span>
                                      <span class="ss">text</span> <span class="o">=</span> config<span class="o">.</span>scripts<span class="o">.</span>output<span class="p">;</span>
      <span class="p">};</span>

  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="submodule-kullanm">Submodule Kullanımı</h2>
<p>Bir tip tanımı için let ve in bloklarını kullanmamız gerekiyor. Burada bir submodule tipi oluşturduk ancak bunu hazır tipleri kullanarak yaptık. Submodule'den kasıt bir önceki örnekte gördüğümüz gibi bir modülü başka bir modülün içine eklemek değildir. Burada aslında bir module ve içindeki option'ları birleştiren bir tip tanımı (subModuleType) yapmış oluyoruz.</p>
<p>İlginç olan bu tipi kullanarak oluşturduğumuz mymodules option'unun tipinin daha önce oluşturduğumuz submodule tipinde liste tutuyor olması <code>lib.types.listOf subModuleType;</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>
<span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span>config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span>

<span class="k">let</span>

      <span class="c1"># bir submodule tipi oluşturduk ve içerisine message adında bir opsiyon ekledik</span>
      <span class="ss">subModuleType</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>submodule <span class="p">{</span>
          <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="ss">message</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
              <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>nullOr lib<span class="o">.</span>types<span class="o">.</span>str<span class="p">;</span>
              <span class="ss">default</span> <span class="o">=</span> <span class="no">null</span><span class="p">;</span>
            <span class="p">};</span>
          <span class="p">};</span>
      <span class="p">};</span>
<span class="k">in</span>
<span class="p">{</span>
    <span class="ss">imports</span> <span class="o">=</span> <span class="p">[</span>
      <span class="l">./my-module.nix</span>
    <span class="p">];</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
          <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>lines<span class="p">;</span>
      <span class="p">};</span>

      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
          <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
      <span class="p">};</span>


      <span class="ss">mymodules</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="c1"># dikkat edilirse subModuleType submodule listesi isteyen bir tip tanımımız var</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>listOf subModuleType<span class="p">;</span>
      <span class="p">};</span>

    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
      scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                      wget https://www.google.com -O /etc/test.txt</span>
<span class="s s-Multiline">                      &#39;&#39;</span><span class="p">;</span>

      scripts<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                                      <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;create-etc&quot;</span><span class="p">;</span>
                                      <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> wget <span class="p">];</span>
                                      <span class="ss">text</span> <span class="o">=</span> config<span class="o">.</span>scripts<span class="o">.</span>output<span class="p">;</span>
      <span class="p">};</span>

    <span class="ss">mymodules</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span><span class="ss">message</span> <span class="o">=</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">;}</span>
      <span class="p">{</span><span class="ss">message</span> <span class="o">=</span> <span class="s2">&quot;how are you?&quot;</span><span class="p">;}</span>
    <span class="p">];</span>

    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<p>Şimdi bu modülü test edelim. İki eleman eklediğimiz için sonuçta iki elemanın da döndüğünü göreceğiz.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate<span class="w"> </span>--eval<span class="w"> </span>eval.nix<span class="w"> </span>-A<span class="w"> </span>config.mymodules
<span class="c1"># [ &lt;CODE&gt; &lt;CODE&gt; ]</span>
</code></pre></div>
<p>Bu arada iç içe submodule tanımlamak da mümkün. Detaylarını <a href="https://nix.dev/tutorials/module-system/module-system.html#nested-submodules">şu sayfadan</a> bakabilirsiniz.</p>
<h2 id="mkif-mkmerge-mkforce-mkdefault-mkoverride-kullanm">mkIf, mkMerge, mkForce, mkDefault, mkOverride Kullanımı</h2>
<p>Belki aklımıza neden <code>if else</code> yapısı kullanmıyoruz da mkIf fonksiyonu kullanıyoruz sorusu aklımıza gelebilir. Bunun sebebi normal <code>if else</code> kullanımının bizi recursion hatasına götüreceği. Bu yüzden mkIf fonksiyonu module kullanımı için yazılmış. Aşağıda mkIf ile yapacağımız örnekleri isterseniz <code>if else</code> yapısı ile de yapabilir ve sonucu görebilirsiniz.</p>
<p><code>mkIf</code> fonksiyonunun kullanımı çok basit.</p>
<div class="highlight"><pre><span></span><code>mkIf <span class="mi">1</span><span class="o">=</span><span class="mi">1</span> <span class="s2">&quot;yes&quot;</span>
<span class="c1"># veya diğer örnek</span>

mkIf <span class="o">!</span><span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="s2">&quot;no&quot;</span>
</code></pre></div>
<p>Normalde mhIfElse gibi bir fonksiyon yok. Ancak forumlarda araştırırsanız sıklıkla alttaki gibi bir yapıyı görebilirsiniz. Bu tarz bir fonksiyon yazarak if else yapısı oluşturabilirsiniz.</p>
<div class="highlight"><pre><span></span><code><span class="ss">mkIfElse</span> <span class="o">=</span> p<span class="p">:</span> yes<span class="p">:</span> no<span class="p">:</span> mkMerge <span class="p">[</span>
  <span class="p">(</span>mkIf p yes<span class="p">)</span>
  <span class="p">(</span>mkIf <span class="p">(</span><span class="o">!</span>p<span class="p">)</span> no<span class="p">)</span>
<span class="p">];</span>
</code></pre></div>
<p>mkMerge farklı konfigürasyonları birleştirmek için kullanılır. Örneğin alttaki gibi bir kullanım yapabiliriz. <code>mkIf</code> ile bir koşula bağlı konfigürasyon başka bir grup konfigürasyonla birleştirilebilir.</p>
<div class="highlight"><pre><span></span><code><span class="ss">config</span> <span class="o">=</span> mkMerge
  <span class="p">[</span> <span class="c1"># Unconditional stuff.</span>
    <span class="p">{</span> environment<span class="o">.</span><span class="ss">systemPackages</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span> <span class="p">];</span>
    <span class="p">}</span>
    <span class="c1"># Conditional stuff.</span>
    <span class="p">(</span>mkIf config<span class="o">.</span>services<span class="o">.</span>bla<span class="o">.</span>enable <span class="p">{</span>
      environment<span class="o">.</span><span class="ss">systemPackages</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span> <span class="p">];</span>
    <span class="p">})</span>
  <span class="p">];</span>
</code></pre></div>
<p><code>my-module.nix</code> dosyamızı çalım ve alttaki değişiklikleri yapalım.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>

      apps<span class="o">.</span>message<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
      <span class="p">};</span>

      apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>bool<span class="p">;</span>
        <span class="ss">default</span> <span class="o">=</span> <span class="no">false</span><span class="p">;</span>
      <span class="p">};</span>


    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> lib<span class="o">.</span>mkMerge <span class="p">[</span> <span class="p">{</span>
                              apps<span class="o">.</span>message<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                                      <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;hello-app&quot;</span><span class="p">;</span>
                                      <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> cowsay <span class="p">];</span>
                                      <span class="ss">text</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                cowsay </span><span class="si">${</span>config<span class="o">.</span>scripts<span class="o">.</span>output<span class="si">}</span>
<span class="s s-Multiline">                                              &#39;&#39;</span><span class="p">;</span>
                                  <span class="p">};</span>
                              apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> <span class="no">true</span><span class="p">;</span>
                        <span class="p">}</span>


                        <span class="p">(</span>lib<span class="o">.</span>mkIf config<span class="o">.</span>apps<span class="o">.</span>message<span class="o">.</span>iswebsiteBing <span class="p">{</span>
                                              scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                          wget https://www.bing.com -O /etc/test.txt</span>
<span class="s s-Multiline">                                                                            &#39;&#39;</span><span class="p">;</span> <span class="p">})</span>
                    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>Önceki versiyonunda hatırlarsanız zaten default.nix modülümüzde tanımlandığımız ve ataması yapılmış <code>scripts.output</code> opiton'ınını alttaki gibi <code>my-module.nix</code> dosyasında tekrar tanımlamıştık.</p>
<div class="highlight"><pre><span></span><code>scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                wget https://www.google.com -O /etc/test.txt</span>
<span class="s s-Multiline">                &#39;&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Yeni versiyonda ise <code>mkIf</code> fonksiyonu ile <code>apps.message.iswebsiteBing</code> option'ına bağlı olarak <code>scripts.output</code> option'ını tekrar tanımladık. Config bloğunu artık mkMerge ile farklı kombinasyonları merge (birleştirecek) şekilde tanımladığımıza dikkat edin.</p>
<p>Şimdi bu değişiklikten sonra tekrar test edelim.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate<span class="w"> </span>--eval<span class="w"> </span>eval.nix<span class="w"> </span>-A<span class="w"> </span>config.scripts.output
<span class="c1"># &quot;wget https://www.bing.com -O /etc/test.txt\n\nwget https://www.google.com -O /etc/test.txt\n&quot;</span>
</code></pre></div>
<p>Sonuçta bir gariplik olduğunu görebiliyoruz. Hem <code>default.nix</code> hem de <code>my-module.nix</code> dosyalarında atadığımız değerleri birleştirerek bize döndürdü. Eğer bizim için <code>my-module.nix</code> modülündeki atama diğer bütün modüllerdeki atamalardan önemliyse o zaman mkForce fonksiyonunu kullanmalıyız. Kodu alttaki gibi düzenliyoruz.</p>
<div class="highlight"><pre><span></span><code>                        <span class="p">(</span>lib<span class="o">.</span>mkIf config<span class="o">.</span>apps<span class="o">.</span>message<span class="o">.</span>iswebsiteBing <span class="p">{</span>
                                              scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkForce <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                          wget https://www.bing.com -O /etc/test.txt</span>
<span class="s s-Multiline">                                                                            &#39;&#39;</span><span class="p">;</span> <span class="p">})</span>
</code></pre></div>
<p>Tekrar test ettiğimizde artık sonucun düzeldiğini görebiliyoruz.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate <span class="o">--</span>eval eval<span class="o">.</span>nix <span class="o">-</span>A config<span class="o">.</span>scripts<span class="o">.</span>output <span class="o">--</span>show-trace
<span class="c1"># &quot;wget https://www.bing.com -O /etc/test.txt\n&quot;</span>
</code></pre></div>
<p><code>mkForce</code> fonksiyonunun nasıl çalıştığını anlarsak diğerlerini de çözmüş olacağız. Bunun için <code>lib.modules.nix</code> dosyasına bir göz atalım. Kod bloğuna <a href="https://github.com/NixOS/nixpkgs/blob/8bee50f7085e913db0f1809f6287d4d84aef5af0/lib/modules.nix#L999C2-L1037C26">şu linkten</a> ulaşabilirsiniz.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># modules.nix</span>

<span class="c1"># Kısaltıldı</span>
  <span class="ss">mkOverride</span> <span class="o">=</span> priority<span class="p">:</span> content<span class="p">:</span>
    <span class="p">{</span> <span class="ss">_type</span> <span class="o">=</span> <span class="s2">&quot;override&quot;</span><span class="p">;</span>
      <span class="k">inherit</span> priority content<span class="p">;</span>
    <span class="p">};</span>

  <span class="ss">mkOptionDefault</span> <span class="o">=</span> mkOverride <span class="mi">1500</span><span class="p">;</span> <span class="c1"># priority of option defaults</span>
  <span class="ss">mkDefault</span> <span class="o">=</span> mkOverride <span class="mi">1000</span><span class="p">;</span> <span class="c1"># used in config sections of non-user modules to set a default</span>
  <span class="ss">defaultOverridePriority</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  <span class="ss">mkImageMediaOverride</span> <span class="o">=</span> mkOverride <span class="mi">60</span><span class="p">;</span> <span class="c1"># image media profiles can be derived by inclusion into host config, hence needing to override host config, but do allow user to mkForce</span>
  <span class="ss">mkForce</span> <span class="o">=</span> mkOverride <span class="mi">50</span><span class="p">;</span>
  <span class="ss">mkVMOverride</span> <span class="o">=</span> mkOverride <span class="mi">10</span><span class="p">;</span> <span class="c1"># used by ‘nixos-rebuild build-vm’</span>

  <span class="ss">defaultPriority</span> <span class="o">=</span> lib<span class="o">.</span>warnIf <span class="p">(</span>lib<span class="o">.</span>isInOldestRelease <span class="mi">2305</span><span class="p">)</span> <span class="s2">&quot;lib.modules.defaultPriority is deprecated, please use lib.modules.defaultOverridePriority instead.&quot;</span> defaultOverridePriority<span class="p">;</span>

  <span class="ss">mkFixStrictness</span> <span class="o">=</span> lib<span class="o">.</span>warn <span class="s2">&quot;lib.mkFixStrictness has no effect and will be removed. It returns its argument unmodified, so you can just remove any calls.&quot;</span> id<span class="p">;</span>

  <span class="ss">mkOrder</span> <span class="o">=</span> priority<span class="p">:</span> content<span class="p">:</span>
    <span class="p">{</span> <span class="ss">_type</span> <span class="o">=</span> <span class="s2">&quot;order&quot;</span><span class="p">;</span>
      <span class="k">inherit</span> priority content<span class="p">;</span>
    <span class="p">};</span>

  <span class="ss">mkBefore</span> <span class="o">=</span> mkOrder <span class="mi">500</span><span class="p">;</span>
  <span class="ss">defaultOrderPriority</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="ss">mkAfter</span> <span class="o">=</span> mkOrder <span class="mi">1500</span><span class="p">;</span>
<span class="c1"># Kısaltıldı</span>
</code></pre></div>
<p><code>mkForce = mkOverride 50;</code> satırına dikkat ederseniz mkOverride ile değeri 50 olarak atanmış. Burada düşük değer daha üstte bir değer. <code>mkDefault = mkOverride 1000;</code> satırı ile default değerin 1000 olduğunu görebiliyoruz. Dolayısıyla <code>mkForce</code> fonksiyonu ile bir değer atadığımızda bu değer diğer bütün değerlerden öncelikli oluyor.</p>
<p>Normal şartlarda modülleri import ederken sıralama yapmamıza gerek yoktur. Hatırlarsanız <code>default.nix</code> dosyamızda imports diye modüle adreslerinin listesini tutan bir değişkenimiz vardı.Diyelim ki aynı opiton'ın değerini farklı iki modüle değiştiriyor olsun. Bu durumda bu iki module import edildiğinde ikinci import edilen birincideki değeri ezecektir. Ancak <strong>conflict</strong> oluşturan bir durum olursa bunu bizim çözmemiz gerekir.</p>
<p>Birde <strong>conflict</strong> durumunu örnekleyelim. Adı<code>my-module-first.nix</code> olan bir dosya oluşturalım. içeriği de alttaki gibi olsun. Bu sefer <code>my-module.nix</code> içinde oluşturduğumuz ve atamasını ad yaptığımız <code>apps.message.iswebsiteBing</code> option'ının değerini bu sefer false olarak ayarladık.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span><span class="ss">config</span> <span class="o">=</span> <span class="p">{</span> apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> <span class="no">false</span><span class="p">;</span> <span class="p">};}</span>
</code></pre></div>
<p>Bu modülü <code>default.nix</code> dosyasındaki imports listesine birinci ve diğer modül de ikinci olarak ekleyelim. Yani alttaki gibi olacak.</p>
<p>Olayı bi anlamaya çalışalım. Normalde <code>default.nix</code> dosyasında tanımlı olan <code>scripts.output</code> option'ı google.com'a giderken biz onu iswebsiteBing option'ı true olursa mkForce fonksiyonunu kullanarak bing.com'a gidecek şekilde <code>my-module.nix</code> dosyamızda ayarlamıştık.</p>
<p>Şimdi yeni modülümüzde ise iswebsiteBing option'ı false olarak ayarladık. Bu durumda <code>default.nix</code> dosyasında tanımlı olan <code>scripts.output</code> option'ı google.com'a gidecek şekilde ayarlanmasını bekliyoruz.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default.nix</span>
    <span class="ss">imports</span> <span class="o">=</span> <span class="p">[</span>
      <span class="l">./my-module-first.nix</span>
      <span class="l">./my-module.nix</span>
    <span class="p">];</span>
</code></pre></div>
<p>Bi test edelim bakalım.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate<span class="w"> </span>--eval<span class="w"> </span>eval.nix<span class="w"> </span>-A<span class="w"> </span>config.scripts.output<span class="w"> </span>--show-trace

<span class="c1"># error: The option `apps.message.iswebsiteBing&#39; has conflicting definition values:</span>
<span class="c1">#  - In `/home/.../tests/my-module.nix&#39;: true</span>
<span class="c1">#  - In `/home/.../tests/my-module-first.nix&#39;: false</span>
<span class="c1">#  Use `lib.mkForce value` or `lib.mkDefault value` to change the priority on any of these definitions.</span>
</code></pre></div>
<p>Fakat conflict oluştu ve sebebi de gayet açık. Biri true derken diğeri false diyor. Bu tarz bir durumu mesela lattaki gibi bir kod yazsaydık da yaşayacaktık</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span><span class="ss">config</span> <span class="o">=</span> <span class="p">{</span> apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkMerge <span class="p">[</span><span class="no">false</span> <span class="no">true</span><span class="p">];</span> <span class="p">};}</span>
</code></pre></div>
<p>işte bu tarz bi durumu yönetmek için de mkOverride fonksiyonu kullanılabilir. <code>my-module-first.nix</code> dosyasını alttaki gibi değiştirelim.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span><span class="ss">config</span> <span class="o">=</span> <span class="p">{</span> apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOverride <span class="mi">50</span> <span class="no">false</span><span class="p">;</span> <span class="p">};}</span>
</code></pre></div>
<p>Tekrar test edelim.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># nix-instantiate --eval eval.nix -A config.scripts.output --show-trace</span>
<span class="s2">&quot;wget https://www.google.com -O /etc/test.txt\n&quot;</span>
</code></pre></div>
<p>Ve evet sonuç istediğimiz gibi oldu. Yani sonradan yüklenen modülün option değeri daha öncelikli olmasına rağmen onu mkOverride ile ezmiş olduk. Yukarıda göreceğiniz üzere mkForce fonksiyonu önceliği 50 olarak ayarlıyor ancak bir mkOverride ile daha 30 olarak ayarladığımız için sonuçta mkOverride fonksiyonu daha öncelikli oldu.</p>
<h2 id="mkorder-mkbefore-ve-mkafter-kullanm">mkOrder, mkBefore ve mkAfter Kullanımı</h2>
<p>Bazen de bir değer iki farklı yerde atanabilir ancak conflict oluşturmayabilir. Conflict durumları çoğunlukla scalar ve boolean değerlerde olur ki bu da gayet normal. Boolean'a örnek olarak mesela bir şeye hem doğru hem yanlış diyemeyiz. Scalar'a örnek olarak mesela bir ses seviyesine hem 50 hem de 100 diyemeyiz. Ama mesela bir isim listesini farklı şekillerde atayabiliriz. Yani her atamada farklı isimler olabilir. Bu durumda conflict oluşmaz.</p>
<p>Conflict oluşturmayan bu tip durumlarda bazen sonra eklenen modül öncekini ezer yada örneğin bir liste ise bunlar birleştirilir ancak yine sonra gelen öncekinden daha önce listeye eklenir.. Ancak bu işimize gelmeyebilir. Yani biz önce eklediğimiz modülün sonrakinden daha öncelikli olmasını isteyebiliriz.</p>
<p>Birde bunun için örnek yapalım.</p>
<p><code>my-module.nix</code> dosyasını alttaki gibi değiştirelim. Str (metin) tiğinde liste tutan bir option ekleyip daha sonra<code>apps.message.list = [ "test4" "test5" "test6" ];</code> şeklinde değerler ekledik.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> pkgs<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

    <span class="ss">options</span> <span class="o">=</span> <span class="p">{</span>

      apps<span class="o">.</span>message<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>package<span class="p">;</span>
      <span class="p">};</span>

      apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>bool<span class="p">;</span>
        <span class="ss">default</span> <span class="o">=</span> <span class="no">false</span><span class="p">;</span>
      <span class="p">};</span>


      apps<span class="o">.</span>message<span class="o">.</span><span class="ss">list</span> <span class="o">=</span> lib<span class="o">.</span>mkOption <span class="p">{</span>
        <span class="ss">type</span> <span class="o">=</span> lib<span class="o">.</span>types<span class="o">.</span>listOf lib<span class="o">.</span>types<span class="o">.</span>str<span class="p">;</span>
      <span class="p">};</span>


    <span class="p">};</span>

    <span class="ss">config</span> <span class="o">=</span> lib<span class="o">.</span>mkMerge <span class="p">[</span> <span class="p">{</span>
                              apps<span class="o">.</span>message<span class="o">.</span><span class="ss">paket</span> <span class="o">=</span> pkgs<span class="o">.</span>writeShellApplication <span class="p">{</span>
                                      <span class="ss">name</span> <span class="o">=</span> <span class="s2">&quot;hello-app&quot;</span><span class="p">;</span>
                                      <span class="ss">runtimeInputs</span> <span class="o">=</span> <span class="k">with</span> pkgs<span class="p">;</span> <span class="p">[</span> cowsay <span class="p">];</span>
                                      <span class="ss">text</span> <span class="o">=</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                cowsay </span><span class="si">${</span>config<span class="o">.</span>scripts<span class="o">.</span>output<span class="si">}</span>
<span class="s s-Multiline">                                              &#39;&#39;</span><span class="p">;</span>
                                  <span class="p">};</span>
                              apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> <span class="no">true</span><span class="p">;</span>

                              apps<span class="o">.</span>message<span class="o">.</span><span class="ss">list</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;test4&quot;</span> <span class="s2">&quot;test5&quot;</span> <span class="s2">&quot;test6&quot;</span> <span class="p">];</span>


                        <span class="p">}</span>


                        <span class="p">(</span>lib<span class="o">.</span>mkIf config<span class="o">.</span>apps<span class="o">.</span>message<span class="o">.</span>iswebsiteBing <span class="p">{</span>
                                              scripts<span class="o">.</span><span class="ss">output</span> <span class="o">=</span> lib<span class="o">.</span>mkOverride <span class="mi">100</span> <span class="s s-Multiline">&#39;&#39;</span>
<span class="s s-Multiline">                                                          wget https://www.bing.com -O /etc/test.txt</span>
<span class="s s-Multiline">                                                                            &#39;&#39;</span><span class="p">;</span> <span class="p">})</span>


                    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p><code>my-module-first.nix</code> dosyasını da alttaki gibi değiştirdik.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>
  <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOverride <span class="mi">50</span> <span class="no">false</span><span class="p">;</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">list</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;test1&quot;</span> <span class="s2">&quot;test2&quot;</span> <span class="s2">&quot;test3&quot;</span> <span class="p">];</span>
    <span class="p">};</span>
  <span class="p">}</span>
</code></pre></div>
<p><code>default.nix</code> dosyasında ise <code>my-module-first.nix</code> modülünü <code>my-module.nix</code> modülünden önce import etmiştik. Bu haliyle test edelim. Sonu string ve xmp parametreleriyle aldık çünkü bunları koymadığımızda sistem listedeki değerleri hesaplamıyor.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate <span class="o">--</span>eval eval<span class="o">.</span>nix <span class="o">-</span>A config<span class="o">.</span>apps<span class="o">.</span>message<span class="o">.</span>list <span class="o">--</span>xml <span class="o">--</span>strict

<span class="c1"># &lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<span class="c1"># &lt;expr&gt;</span>
<span class="c1">#   &lt;list&gt;</span>
<span class="c1">#     &lt;string value=&quot;test4&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test5&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test6&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test1&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test2&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test3&quot; /&gt;</span>
<span class="c1">#   &lt;/list&gt;</span>
<span class="c1"># &lt;/expr&gt;</span>
</code></pre></div>
<p>Görüldüğü üzere sistem sonra eklenen modüldeki değerleri listeye daha önce ekledi mer ederken.Halbuki biz değerleri sıralı istiyorduk diyelim.
Bu durumda <code>my-module-first.nix</code> modülünde alttaki gibi değişiklik yapıyoruz.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

  <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOverride <span class="mi">50</span> <span class="no">false</span><span class="p">;</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">list</span> <span class="o">=</span>lib<span class="o">.</span>mkBefore <span class="p">[</span> <span class="s2">&quot;test1&quot;</span> <span class="s2">&quot;test2&quot;</span> <span class="s2">&quot;test3&quot;</span> <span class="p">];</span>
    <span class="p">};</span>

  <span class="p">}</span>
</code></pre></div>
<p>Şimdi test edelim. Evet sonuç istediğimiz gibi oldu.</p>
<div class="highlight"><pre><span></span><code>nix-instantiate <span class="o">--</span>eval eval<span class="o">.</span>nix <span class="o">-</span>A config<span class="o">.</span>apps<span class="o">.</span>message<span class="o">.</span>list <span class="o">--</span>xml <span class="o">--</span>strict
<span class="c1"># &lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<span class="c1"># &lt;expr&gt;</span>
<span class="c1">#   &lt;list&gt;</span>
<span class="c1">#     &lt;string value=&quot;test1&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test2&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test3&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test4&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test5&quot; /&gt;</span>
<span class="c1">#     &lt;string value=&quot;test6&quot; /&gt;</span>
<span class="c1">#   &lt;/list&gt;</span>
<span class="c1"># &lt;/expr&gt;</span>
</code></pre></div>
<p>Eğer buradaki modülden daha fazla yerde atama yapmış olsaydık bu durumda mkOrder fonksiyonunu kullanacaktık. Her bir modülde alttaki gibi bir sıra no verecektik.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> lib<span class="p">,</span> config<span class="p">,</span><span class="o">...</span> <span class="p">}:</span> <span class="p">{</span>

  <span class="ss">config</span> <span class="o">=</span> <span class="p">{</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">iswebsiteBing</span> <span class="o">=</span> lib<span class="o">.</span>mkOverride <span class="mi">50</span> <span class="no">false</span><span class="p">;</span>
    apps<span class="o">.</span>message<span class="o">.</span><span class="ss">list</span> <span class="o">=</span>lib<span class="o">.</span>mkOrder <span class="mi">10</span> <span class="p">[</span> <span class="s2">&quot;test1&quot;</span> <span class="s2">&quot;test2&quot;</span> <span class="s2">&quot;test3&quot;</span> <span class="p">];</span>
    <span class="p">};</span>

  <span class="p">}</span>
</code></pre></div>
<p>Evet bu yazımızın da sonuna geldik. Bu yazımızda somut olarak modül yazmadık. Amacımız yazarken nelere dikkat etmeliyiz ve nasıl hata çözebiliriz buna odaklanmaktı. Bir sonraki yazımızda artık somut olarak bir önceki yazımızda kurmuş olduğumuz NixOS kurulumundan devam edeceğiz, home-manager'ı inceleyeceğiz.</p>
<h2 id="modul-ve-optionlar-daha-detayl-ogrenmek-icin-kaynaklar">Modül ve Option'ları Daha Detaylı Öğrenmek İçin Kaynaklar</h2>
<ul>
<li><a href="https://nixos.org/manual/nixos/stable/#sec-writing-modules">NixOS manual</a></li>
<li><a href="https://nixos.wiki/wiki/NixOS_modules">NixOS Wiki</a></li>
<li><a href="https://nix.dev/tutorials/module-system/module-system.html">Nix Language</a></li>
<li><a href="https://nixos-and-flakes.thiscute.world/nixos-with-flakes/modularize-the-configuration">NixOS Non-Official</a></li>
</ul>
<h2 id="kaynaklar">Kaynaklar</h2>
<ul>
<li><a href="https://github.com/Misterio77/nix-starter-configs/tree/main">https://github.com/Misterio77/nix-starter-configs/tree/main</a></li>
<li><a href="https://nixos-and-flakes.thiscute.world/nixos-with-flakes/modularize-the-configuration">https://nixos-and-flakes.thiscute.world/nixos-with-flakes/modularize-the-configuration</a></li>
<li><a href="https://www.tweag.io/blog/2020-07-31-nixos-flakes/">https://www.tweag.io/blog/2020-07-31-nixos-flakes/</a></li>
<li><a href="https://jade.fyi/blog/flakes-arent-real/">https://jade.fyi/blog/flakes-arent-real/</a></li>
<li><a href="https://github.com/mikeroyal/NixOS-Guide">https://github.com/mikeroyal/NixOS-Guide</a></li>
<li><a href="https://nixos.wiki/wiki/NixOS_modules">https://nixos.wiki/wiki/NixOS_modules</a></li>
<li><a href="https://nix.dev/tutorials/module-system/module-system.html">https://nix.dev/tutorials/module-system/module-system.html</a></li>
<li><a href="https://nixos.org/manual/nixos/stable/#sec-writing-modules">https://nixos.org/manual/nixos/stable/#sec-writing-modules</a></li>
<li><a href="https://dev.to/dooygoy/100-days-of-nixos-346e">https://dev.to/dooygoy/100-days-of-nixos-346e</a></li>
<li><a href="https://github.com/rasendubi/dotfiles">https://github.com/rasendubi/dotfiles</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.prune", "content.action.edit", "content.action.view", "search.suggest", "search.highlight"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Kopyaland\u0131", "clipboard.copy": "Kopyala", "search.result.more.one": "Bu sayfada 1 tane daha", "search.result.more.other": "Bu sayfada # tane daha", "search.result.none": "E\u015fle\u015fen dok\u00fcman bulunamad\u0131", "search.result.one": "1 dok\u00fcman bulundu", "search.result.other": "# dok\u00fcman bulundu", "search.result.placeholder": "Aramaya ba\u015flamak i\u00e7in yaz\u0131n", "search.result.term.missing": "Eksik", "select.version": "Versiyon se\u00e7"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>